# ReGAIT
[![GitHub issues](https://img.shields.io/github/issues/sccn/bmsilab?color=%23fa251e&logo=GitHub)](https://github.com/bmislab/ReGAIT_ESG/issues)
![Twitter Follow](https://img.shields.io/twitter/follow/BMISLab?style=social)

# What is BMIsLAB?
The Brain-Machine Interface Systems Lab (BMIsLAB) is a team of researchers led by José María Azorín. Our work focuses on human-machine interaction through brain control in order to improve human capabilities in neural rehabilitation.
This repository is an open source signal processing environment for electrospinography (ESG) signals running on Matlab. This folder contains original Matlab functions from the BMISLAB that have been adapted to the context of the project ReGAIT.

# ECG Denoising and Statistical Analysis Toolbox
This MATLAB toolbox enables the analysis of ESG database files, focusing on the evaluation and statistical comparison of various electrocardiogram (ECG) denoising algorithms.
 
# Overview
The repository includes two primary scripts:

- ESG_ECG_filtering.m
Processes all files in the database and evaluates the performance of multiple ECG filtering algorithms, including:
TS, ATS, HP200, HP200+ATS, SWT, EKS2, and EMD.

- ESG_ECG_statistics.m
Conducts statistical analysis of the denoising algorithms using the results table generated by ESG_ECG_filtering.m. The script evaluates algorithmic performance across various metrics and anatomical matrices (Brachial / Lumbar).

# ECG Denoising Functions
The primary preprocessing function is process_matrix, which performs the main signal processing operations. Proper operation of this function requires the inclusion of Petersen’s cardiac artifact removal toolbox, available at: https://github.com/ime-luebeck/ecg-removal/releases/tag/1.1

Supporting subfunctions include:

- calculate_parameters: Computes the performance metrics used for algorithm comparison.

- build_results_table: Formats and compiles the performance metrics for subsequent statistical analysis.

Additional auxiliary functions provide bandpass filtering and apply multiple notch filters using a state-variable filter design:

- comb_filter, read_func, state_filter, state_filter_sample and filter_setup.

# Statistical Analysis Functions

Several MATLAB functions are employed in the statistical analysis process, each corresponding to a specific evaluation step:

- kstest: Performs the Kolmogorov–Smirnov test to assess the normality of the data distribution for each metric, algorithm and matrix configuration.

- vartestn: Executes Levene’s test to evaluate the homogeneity of variances across groups of metrics and matrix configuration, ensuring statistical comparability.

- Friedman: Conducts the Friedman test to determine overall differences in algorithm performance according to the selected metric and matrix configuration and to compare performance across matrices for each metric and algorithm.

- ranksum: Applies the Wilcoxon rank-sum test for pairwise comparisons, assessing significant differences between pairs of algorithms (per metric and matrix) and between pairs of matrices (per metric and algorithm).

All statistical results, including p-values and effect sizes, are automatically compiled and saved in the structured output file statistical_results.mat for subsequent analysis and visualization.

# Run

To process the provided datasets, apply ECG-removal algorithms, and save the results:

ESG_ECG_filtering.m

To load the filtered datasets and perform statistical comparisons:

ESG_ECG_statistics.m

# Requirements
- MATLAB R2018b or newer
- Petersen's ECG Artifact Removal Toolbox (see link above)

# License
This software is distributed under the MIT License. See below for full terms.

# MIT License
Copyright Copyright 2025, Brain-Machine Interfaces Systems Lab, 
Universidad Miguel Hernández de Elche
Author: Desirée I. Gracia, Eduardo Iáñez, Mario Ortiz, Jose M. Azorin

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

# In publications, please reference:

# Funding
This publication is part of grant PID2021-124111OB-C31, funded by MICIU/AEI/10.13039/501100011033 and by ERDF, EU. This research has been also supported by grant CIACIF/2022/108 funded by ``Consellería de Educación, Universidades y Empleo (Generalitat Valenciana)" and the European Social Fund, and grant PRE2022-103336 funded by MICIU/AEI/10.13039/501100011033 and by ESF+.




